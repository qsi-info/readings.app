"use strict";angular.module("ReadingsApp",["oauth","ngCookies","ngResource","ngRoute","cfp.loadingBar"]).config(["$routeProvider",function(a){a.when("/access_token=:accessToken",{template:"",controller:["$location","AccessToken",function(a,b){var c=a.path().substr(1);b.setTokenFromString(c),a.path("/"),a.replace()}]}).when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/readings/classeurhuile",{templateUrl:"views/readings/classeurhuile.html",controller:"ReadingCtrl"}).when("/readings/cristallisation",{templateUrl:"views/readings/cristallisation.html",controller:"ReadingCtrl"}).when("/readings/chaudieres",{templateUrl:"views/readings/chaudieres.html",controller:"ReadingCtrl"}).when("/readings/stdp",{templateUrl:"views/readings/stdp.html",controller:"ReadingCtrl"}).when("/readings/hydrogene",{templateUrl:"views/readings/hydrogene.html",controller:"ReadingCtrl"}).when("/readings/verifications",{templateUrl:"views/readings/verifications.html",controller:"ReadingCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$http","$cookieStore","AccessToken","cfpLoadingBar",function(a,b,c,d,e){a.API_SITE=$("oauth").attr("site"),c.put("API_SITE",$("oauth").attr("site")),c.get("app")&&(a.app=c.get("app")),c.get("profile")&&(a.profile=c.get("profile")),a.$on("oauth:login",function(){b.defaults.headers.common.Authorization="Bearer "+d.get().access_token,b.get(a.API_SITE+"/api/me").success(function(b){c.put("profile",b),a.profile=b}),b.get(a.API_SITE+"/api/info").success(function(b){c.put("app",b),a.app=b})}),a.$on("oauth:logout",function(){"ActiveXObject"in window&&document.execCommand("ClearAuthenticationCache",!1),a.profile={},a.app={},c.remove("profile"),c.remove("app"),c.remove("API_SITE")}),a.$on("$routeChangeSuccess",function(){e.complete()})}]);var app=angular.module("ReadingsApp");app.factory("Item",["$rootScope","$resource",function(a,b){return b(a.API_SITE+"/item/:id",null,{update:{method:"PUT"}})}]);var app=angular.module("ReadingsApp");app.controller("MainCtrl",function(){});var app=angular.module("ReadingsApp");app.controller("ReadingCtrl",["$scope","cfpLoadingBar",function(a,b){function c(){a.server="http://paradevsrv02/reportserver",a.folder=$("#folder").val(),a.today=new Date,a.datepicker=$("#datepicker").datepicker({todayHighlight:!0,format:"yyyy-mm-dd",autoclose:!0}).on("changeDate",function(b){var c=b.date;d(c,a.server,a.folder)}),a.datepicker.datepicker("setDate",a.today)}function d(c,d,f){b.start();var g="rs:Command=Render&rc:Toolbar=false",h=moment(c).format("YYYY-MM-D")+"T00:00:00";a.frameCounter=0,$(".report").each(function(){a.frameCounter++;var b=$(this).attr("data-report"),c=d+"?"+f+b+"&"+g+"&lecture="+h;$(this).attr("src",c),$(this).on("load",function(){a.frameCounter--,e()})})}function e(){a.frameCounter<=0&&b.complete()}c(),a.foward=function(){var b=moment(a.datepicker.datepicker("getDate"));a.datepicker.datepicker("setDate",new Date(b.add(1,"d").format()))},a.back=function(){var b=moment(a.datepicker.datepicker("getDate"));a.datepicker.datepicker("setDate",new Date(b.subtract(1,"d").format()))}}]);